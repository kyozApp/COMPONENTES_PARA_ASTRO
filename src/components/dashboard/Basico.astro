---
import { Image } from "astro:assets";
import logo from '@assets/dashboard/@kyozApp.png';
---

<main class="main">
    <header class="header">
        <div class="containerImage">
            <Image 
            src={logo}
            alt="logo"
            loading="eager"
            class="logo"
            />
        </div>        
        <div class="containerUser">
            <button class="user"><svg viewBox="0 -960 960 960" fill="currentColor" class="iconUser"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg></button>
            <ul class="listUser">
                <li class="listItemUser"><a href="#" class="itemUser">Perfil</a></li>
                <li class="listItemUser"><a href="#" class="itemUser">Config</a></li>
                <li class="listItemUser"><a href="#" class="itemUser">Salir</a></li>
            </ul>
        </div>
        <div class="containerMenu">
            <button class="menu"><svg viewBox="0 -960 960 960" fill="currentColor" class="iconMenu"><path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"/></svg></button>
        </div>
    </header>
    <aside class="aside">
        <a href="#" class="groupContent">Contenido</a>        
        <div class="group">
            <a href="#" class="groupTitle1">Titulo1</a>
            <ul class="content1">
                <li class="contentLi"><a href="#" class="groupContent">Contenido1</a></li>
                <li class="contentLi"><a href="#" class="groupContent">Contenido2</a></li>
            </ul>
        </div>
        <div class="group">
            <a href="#" class="groupTitle2">Titulo2</a>
            <ul class="content2">
                <li class="contentLi"><a href="#" class="groupContent">Contenido3</a></li>
                <li class="contentLi"><a href="#" class="groupContent">Contenido4</a></li>
            </ul>
        </div>
        <div class="group">
            <a href="#" class="groupTitle3">Titulo3</a>
            <ul class="content3">
                <li class="contentLi"><a href="#" class="groupContent">Contenido5</a></li>
                <li class="contentLi"><a href="#" class="groupContent">Contenido6</a></li>
            </ul>
        </div>
    </aside>
    <section class="section">
        <slot />
    </section>
    <footer class="footer">
        Footer
    </footer>

</main>

<style>
    /* Fondos y colores para mi componente */
    :root {
        --header-fondo: rgba(255, 0, 8, 0.974);
        --header-user: rgb(0, 0, 0);
        --header-menu: rgb(0, 0, 0);
        --header-container-img: rgb(36, 88, 184);
        --header-container-user: rgb(184, 36, 36);
        --header-container-menu: rgb(66, 184, 36);
        --header-list-user: rgb(226, 183, 183);
        --aside-fondo: rgba(255, 0, 0, 0.392);
        --section-fondo: rgba(0, 0, 255, 0.392);
        --footer-fondo: rgba(0, 255, 0, 0.392);
    }


    /* Estilos para el contenedor principal con clase 'main' */
    .main {
        min-height: 100dvh;
        display: grid;
        grid-template-columns: 150px 1fr;
        grid-template-rows: 80px 1fr 50px;
        grid-template-areas:
            "header header"
            "aside main"
            "aside footer";
    }

    .mainAsideHidden {
        grid-template-areas:
            "header header"
            "main main"
            "footer footer";
    }

    /* Estilos para el header dentro del contenedor 'main' */
    .header {
        background: var(--header-fondo);
        grid-area: header;
        display: grid;
        grid-template-columns: 1fr 80px 120px;
        grid-template-rows: 80px;
        position: sticky;
        top: 0;
        z-index: 100;
        grid-template-areas: 
            "containerImage containerUser containerMenu";
    }

    .containerImage:nth-child(1) {
        grid-area: containerImage;
        display: flex;
        justify-content: center;
        align-items: center;
        background: var(--header-container-img);
    }

    .logo {
        height: 50px;
        width: 80%;
    }   

    .containerUser:nth-child(2) {
        grid-area: containerUser;
        display: flex;
        justify-content: center;
        align-items: center;
        background: var(--header-container-user);
    }

    .user {
        color: var(--header-user);
        width: 40px;
        height: 40px;
    }

    .listUser {
        list-style: none;
        background: var(--header-list-user);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: start;
        position: absolute;
        top: 80px;
        right: 120px;
        width: auto;
        height: auto;
        padding: 20px 70px 20px 10px;
        gap: 10px;
        border-radius: 8px;
    }

    .listUserVisible {
        display: flex;
    }

    .itemUser {
        text-decoration: none;
    }

    .containerMenu:nth-child(3) {
        grid-area: containerMenu;
        display: flex;
        justify-content: center;
        align-items: center;
        background: var(--header-container-menu);
    }

    .menu {
        color: var(--header-menu);
        width: 40px;
        height: 40px;
    }


    /* Estilos para el aside dentro del contenedor 'main' */
    .aside {
        background: var(--aside-fondo);
        grid-area: aside;
        display: flex;
        flex-direction: column;
        position: sticky;
        top: 80px;
        height: calc(100dvh - 80px);
        gap: 20px;
        padding: 20px 0 0 20px;
    }

    .asideHidden {
        display: none;
    }

    .groupTitle1, .groupTitle2, .groupTitle3 {   
        text-decoration: none;  
    }

    .content1, .content2, .content3 {
        display: none;
        flex-direction: column;
        gap: 10px;
        padding: 20px 0 0 0;
    }

    .contentVisible {
        display: flex;
    }

    .contentLi {
        list-style: none;
    }

    .groupContent {
        text-decoration: none;
    }


    /* Estilos para el section dentro del contenedor 'main' */
    .section {
        background: var(--section-fondo);
        grid-area: main;
        z-index: 50;
    }
    

    /* Estilos para el footer dentro del contenedor 'main' */
    .footer {
        background: var(--footer-fondo);
        grid-area: footer;
    }

    @media (width >= 465px) {
        .header {
            grid-template-columns: 280px 80px 1fr 120px;
            grid-template-areas: 
                "containerImage containerMenu vacio containerUser";
        }
        
        .containerImage:nth-child(1) {
            justify-content: center;
        }
        
        .logo {
            width: 80%;
        }

        .listUser {
            right: 40px;
        }
    }
</style>

<script>
    // Mostrar y ocultar el menu
    const main = document.querySelector('.main');
    const menu = document.querySelector('.menu');
    const aside = document.querySelector('.aside');    

    menu?.addEventListener('click', () => {
        if (aside) {
            aside.classList.toggle('asideHidden');

            if (aside.classList.contains('asideHidden')) {
                main?.classList.add('mainAsideHidden');
            } else {
                main?.classList.remove('mainAsideHidden');
            }
        }
    });

    // Mostrar y ocultar el user
    const user = document.querySelector('.user');
    const listUser = document.querySelector('.listUser');

    if (user) {
        user.addEventListener('click', (event) => {
            event.stopPropagation();
            if (listUser) {
                listUser.classList.toggle('listUserVisible');
            }
        });

        document.addEventListener('click', (event) => {
            const target = event.target as Node;
            if (
                listUser &&
                listUser.classList.contains('listUserVisible') &&
                !listUser.contains(target) &&
                !user.contains(target)
            ) {
                listUser.classList.remove('listUserVisible');
            }
        });
    }

    // mostrar y ocultar el content
    const content1 = document.querySelector('.content1');
    const content2 = document.querySelector('.content2');
    const content3 = document.querySelector('.content3');
    const groupTitle1 = document.querySelector('.groupTitle1');
    const groupTitle2 = document.querySelector('.groupTitle2');
    const groupTitle3 = document.querySelector('.groupTitle3');

    groupTitle1?.addEventListener('click', () => {
        if (content1) {
            content1.classList.toggle('contentVisible');
        }
    });
    groupTitle2?.addEventListener('click', () => {
        if (content2) {
            content2.classList.toggle('contentVisible');
        }
    });
    groupTitle3?.addEventListener('click', () => {
        if (content3) {
            content3.classList.toggle('contentVisible');
        }
    });
</script>
